CUDA_VISIBLE_DEVICES=1 python evaluate.py --checkpoint checkpoints2/best.pth --test-dir kaggle/test
Device: cuda
Test set: 20000 images from kaggle/test

============================================================
EVALUATION RESULTS
============================================================

Overall (20000 images, 0 legal):
  Loss:            0.4703
  Per-square acc:  0.9789 (1252956/1280000)
  Full-board acc:  0.6141 (12282/20000)

No legal positions in dataset â€” turn/castling metrics skipped.

Per-piece accuracy:
  empty: 0.9852  (1064328/1080344)
      P: 0.9669  (17520/18119)
      N: 0.8705  (15326/17606)
      B: 0.9541  (16888/17700)
      R: 0.9653  (16927/17536)
      Q: 0.9438  (8291/8785)
      K: 0.9532  (19064/20000)
      p: 0.9871  (17699/17930)
      n: 0.8696  (15330/17628)
      b: 0.9242  (16354/17695)
      r: 0.9782  (17499/17889)
      q: 0.9838  (8626/8768)
      k: 0.9552  (19104/20000)

Confusion matrix (rows=true, cols=predicted):
        empty     P     N     B     R     Q     K     p     n     b     r     q     k
  empty 1064328  5557   797   108   241   915   398  2865   112  1005   605  3342    71
     P      0 17520   120   240     1     2   189    47     0     0     0     0     0
     N      0   208 15326   326  1616    55    40     3    14     0     6    10     2
     B      0    11   597 16888   105    36     2     0     0    61     0     0     0
     R      0   238     0   121 16927   175     0     2     0    11    24    38     0
     Q      0     1    82    40     7  8291   303     0     0     0     0    60     1
     K      0    31    58     6    32   774 19064     0     0     0     0     0    35
     p      1    68     2     0     0     2     3 17699    27    57     0    48    23
     n      0     0    55     0     4     0     0    82 15330    15  2053    69    20
     b      2     0     0    15     0     0     0   489   709 16354     4    88    34
     r      1     6     2     0   219    18     0    54    17     5 17499    68     0
     q      0     1     0     0     0     9     0    26    19     5     0  8626    82
     k      2     0     2     0     0     2    71    48    43    21    20   687 19104

Worst: 32/64 squares (mass hallucination returned)
