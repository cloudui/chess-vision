python evaluate.py --checkpoint checkpoints/best.pth --test-dir kaggle/test
Device: cuda
Test set: 20000 images from kaggle/test

============================================================
EVALUATION RESULTS
============================================================

Overall (20000 images, 0 legal):
  Loss:            0.4636
  Per-square acc:  0.9803 (1254821/1280000)
  Full-board acc:  0.6185 (12370/20000)

No legal positions in dataset â€” turn/castling metrics skipped.

Per-piece accuracy:
  empty: 0.9857  (1064887/1080344)
      P: 0.9632  (17453/18119)
      N: 0.8675  (15274/17606)
      B: 0.9619  (17025/17700)
      R: 0.9740  (17080/17536)
      Q: 0.9160  (8047/8785)
      K: 0.9943  (19886/20000)
      p: 0.9891  (17735/17930)
      n: 0.8673  (15289/17628)
      b: 0.9363  (16568/17695)
      r: 0.9939  (17780/17889)
      q: 0.9051  (7936/8768)
      k: 0.9930  (19861/20000)

Confusion matrix (rows=true, cols=predicted):
        empty     P     N     B     R     Q     K     p     n     b     r     q     k
  empty 1064887  5787  1070   515  1534   900    99  3809   115    35   232  1059   302
     P      0 17453    72   255    44    77   139    78     0     0     0     0     1
     N      0    80 15274   190  1999     5    50     0     5     0     3     0     0
     B      0     6   539 17025    50    10     0     0     1    69     0     0     0
     R      0    77     1    81 17080     0     0     1     0    22   274     0     0
     Q      0     0   109    89    52  8047   445     1     0     0     6    36     0
     K      0     0    77     0    18     6 19886     0     0     0     0     0    13
     p      0    52     2     6     0     0     0 17735    23    53     1     4    54
     n      0     0    18     0     3     0     0   612 15289    12  1641     3    50
     b      1     0     0    26     0     0     0   488   541 16568    45     3    23
     r      0     0     0     0    80     0     0    22     3     1 17780     1     2
     q      0     0     0     0     0   116     0    49    19     3    24  7936   621
     k      1     0     2     0     0     0    48    50    22     2     9     5 19861
