CUDA_VISIBLE_DEVICES=1 python evaluate.py --checkpoint checkpoints_cnn/best.pth --test-dir kaggle/test
Device: cuda
Test set: 20000 images from kaggle/test

============================================================
EVALUATION RESULTS
============================================================

Overall (20000 images, 0 legal):
  Loss:            0.6720
  Per-square acc:  0.9204 (1178076/1280000)
  Full-board acc:  0.4234 (8468/20000)

No legal positions in dataset â€” turn/castling metrics skipped.

Per-piece accuracy:
  empty: 0.9131  (986509/1080344)
      P: 0.9717  (17606/18119)
      N: 0.8761  (15424/17606)
      B: 0.9662  (17101/17700)
      R: 0.9995  (17527/17536)
      Q: 0.9925  (8719/8785)
      K: 0.9617  (19233/20000)
      p: 0.9802  (17575/17930)
      n: 0.8826  (15558/17628)
      b: 0.9627  (17035/17695)
      r: 0.9881  (17676/17889)
      q: 0.9763  (8560/8768)
      k: 0.9777  (19553/20000)

Confusion matrix (rows=true, cols=predicted):
        empty     P     N     B     R     Q     K     p     n     b     r     q     k
  empty 986509 15118  9543  6915  9810 24007 13200  2709  2898  1431  1674  4622  1908
     P      0 17606    77     0   142     0   197    97     0     0     0     0     0
     N      0    55 15424     0  2083     0     7     0     2     0    35     0     0
     B      0     0   554 17101     0     2    12     0     0    31     0     0     0
     R      0     0     0     0 17527     0     0     0     0     0     9     0     0
     Q      1     0     0     0     3  8719    23     0     0     0     0    34     5
     K      0     0   100     0   114   414 19233     0     0     0     0     0   139
     p      0   105    35     0     3     0     2 17575    67     0   112     1    30
     n      1     0    71     0    45     0     0   163 15558    21  1767     2     0
     b      1     0     0    61     0     0     0    14   533 17035     1     0    50
     r      1     0     0     0   207     2     0     0     0     0 17676     3     0
     q      0     0     0     0     0    77     0     0     2     0    89  8560    40
     k      0     0     0     0     0     8    94     0    56     2   204    83 19553
