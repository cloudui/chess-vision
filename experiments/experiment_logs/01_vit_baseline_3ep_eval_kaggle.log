CUDA_VISIBLE_DEVICES=0 python evaluate.py --checkpoint checkpoints/best.pth --test-dir kaggle/test
Device: cuda
Test set: 20000 images from kaggle/test

============================================================
EVALUATION RESULTS
============================================================

Overall (20000 images, 0 legal):
  Loss:            0.4364
  Per-square acc:  0.9905 (1267828/1280000)
  Full-board acc:  0.7540 (15080/20000)

No legal positions in dataset â€” turn/castling metrics skipped.

Per-piece accuracy:
  empty: 0.9998  (1080115/1080344)
      P: 0.9682  (17543/18119)
      N: 0.8604  (15148/17606)
      B: 0.9336  (16525/17700)
      R: 0.9710  (17028/17536)
      Q: 0.8274  (7269/8785)
      K: 0.9754  (19508/20000)
      p: 0.9779  (17534/17930)
      n: 0.8610  (15177/17628)
      b: 0.9460  (16740/17695)
      r: 0.9765  (17469/17889)
      q: 0.9189  (8057/8768)
      k: 0.9858  (19715/20000)

Confusion matrix (rows=true, cols=predicted):
        empty     P     N     B     R     Q     K     p     n     b     r     q     k
  empty 1080115   183     2     1     0     0     1    28     1     3     7     3     0
     P      0 17543   116   179     1    73    40   154     0    13     0     0     0
     N      4   183 15148   297  1774    32    83     7    60     0    17     1     0
     B      2     2   581 16525    22    75    21     0     4   466     1     1     0
     R      0    59     3    21 17028     2    10     0     0    28   383     2     0
     Q      2     8    88    38   127  7269   837     3     2     0    16   365    30
     K      0    26   124     0    28    25 19508     0     0     0     0     0   289
     p      2    59     1     0     0     0     1 17534    38   235     3    18    39
     n      1     0    11     0     3     0     0   529 15177   120  1549    74   164
     b     12     0     0    35     0     0     0   258   416 16740    29   113    92
     r      6     1     3     0    87     0     2   226    30    10 17469    17    38
     q      1     0     0     0     0    54     0    12     9     6    17  8057   612
     k      5     1    12     0     1     1    54    48    53     0    15    95 19715
