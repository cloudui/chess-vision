python evaluate.py --checkpoint checkpoints/best.pth --test-dir kaggle/test
Device: cuda
Test set: 20000 images from kaggle/test

============================================================
EVALUATION RESULTS
============================================================

Overall (20000 images, 0 legal):
  Loss:            0.0875
  Per-square acc:  0.9751 (1248167/1280000)
  Full-board acc:  0.4059 (8118/20000)

No legal positions in dataset â€” turn/castling metrics skipped.

Per-piece accuracy:
  empty: 0.9965  (1076545/1080344)
      P: 0.9400  (17031/18119)
      N: 0.7748  (13642/17606)
      B: 0.8824  (15619/17700)
      R: 0.9301  (16310/17536)
      Q: 0.7711  (6774/8785)
      K: 0.8226  (16453/20000)
      p: 0.9465  (16971/17930)
      n: 0.8055  (14200/17628)
      b: 0.8094  (14322/17695)
      r: 0.9149  (16367/17889)
      q: 0.8272  (7253/8768)
      k: 0.8340  (16680/20000)

Confusion matrix (rows=true, cols=predicted):
        empty     P     N     B     R     Q     K     p     n     b     r     q     k
  empty 1076545   441   103   125    57   133   205  1553   322   375   355    82    48
     P      0 17031     3    79    72     2     9   910     0     8     0     0     5
     N      0   504 13642   598  1187     5   289    36   800    33   404     2   106
     B      0   335    84 15619    37     0   310    53    35  1127     2     2    96
     R      0   128     0    14 16310    14    16    23     0     1  1012    10     8
     Q      0    11     0    39   690  6774   482     0     1     7   109   585    87
     K      0   117    74   213  1516   202 16453     0     7    10     8     7  1393
     p      2   782     0     1     5     0     1 16971     2    88    61     1    16
     n      0   101   297    25    53     0     9   762 14200   285  1307     3   586
     b      1   116     3   280     4     0     4  2207    98 14322    93     3   564
     r      0    11     0     0  1148     1     0   293     2     6 16367    25    36
     q      0     1     0     7    42   393    36    24     0    41   534  7253   437
     k      3    32     5     8   142    12  1426   332    55   159  1052    94 16680
